# 01. ainer-gateway

## 定位
统一入口网关（用户/API/BFF 层）。

## 核心职责
- 提供统一 API 与鉴权入口。
- 校验请求、分配 `trace_id/correlation_id/idempotency_key`。
- 聚合查询任务状态、产物状态、版本信息。
- 对前端提供 SSE/WebSocket 进度推送。

## 输入
- 前端请求（登录、项目、任务提交、重试、取消、查询）。

## 输出
- 标准 API 响应。
- 入口事件：`task.submitted`、`task.cancel.requested`。

## 上下游
- 上游：`14.ainer-studio-web.md`。
- 下游：`02.ainer-orchestrator.md`、`13.ainer-observer.md`。

## 权威事件
- `task.submitted`（唯一生产者：Gateway）。

## 数据边界
- 可读写：用户会话、项目元数据、请求幂等记录。
- 不可写：编排状态机核心状态（由 Orchestrator 权威管理）。

## 失败与回滚
- 幂等冲突：返回冲突码，不重复创建任务。
- 下游不可用：快速失败 + 可重试提示。

## 不负责
- 不做 DAG 编排。
- 不做模型路由与执行。